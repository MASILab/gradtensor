Bootstrap: docker
From: ubuntu:16.04

%help
gradtensor

Gradient coil tensor: estimation from field maps, and correction of b-values

TO BUILD
We expect to build from fmri_conncalc directory:
  sudo singularity build gradtensor_v1.0.0.simg Singularity.v1.0.0 

TO RUN
See the associated YAML files for info about inputs and running the container

%files
  bin /opt/gradtensor/bin
  src /opt/gradtensor/src
  external /opt/gradtensor/external
  LICENSE.txt /opt/gradtensor/LICENSE.txt
  README.md /opt/gradtensor/README.md
  usage-singularity.txt /opt/gradtensor/usage-singularity.txt
 
%labels
  Maintainer baxter.rogers@vanderbilt.edu

%post
  apt-get update
  apt-get install -y wget unzip openjdk-8-jre
  
  # Download the Matlab Compiled Runtime installer, install, clean up
  mkdir /MCR
  wget -nv -P /MCR http://ssd.mathworks.com/supportfiles/downloads/R2017a/deployment_files/R2017a/installers/glnxa64/MCR_R2017a_glnxa64_installer.zip
  unzip /MCR/MCR_R2017a_glnxa64_installer.zip -d /MCR/MCR_R2017a_glnxa64_installer
  /MCR/MCR_R2017a_glnxa64_installer/install -mode silent -agreeToLicense yes
  rm -r /MCR/MCR_R2017a_glnxa64_installer /MCR/MCR_R2017a_glnxa64_installer.zip
  rmdir /MCR

  # Create input/output directories for binding
  mkdir /INPUTS && mkdir /OUTPUTS

%runscript
    /bin/bash -c "cat /opt/gradtensor/usage-singularity.txt"
	
